"use strict";(function(){var e=[].indexOf;jQuery(document).ready(function(r){var t,i,a,s,n,c,o,d,_,p,u,l,h,f,m,w,k;if(k=null!=(f=window.typenow)?f:"",h=null!=(m=window.pagenow)?m:"","product"===k&&wc_square_admin_products.is_product_sync_enabled)return"edit-product"===h&&r("#the-list").on("click",".editinline",function(){var e,t,i;return e=r(this).closest("tr"),i=e.find("th.check-column input").val(),t={action:"wc_square_get_quick_edit_product_details",security:wc_square_admin_products.get_quick_edit_product_details_nonce,product_id:e.find("th.check-column input").val()},r.post(wc_square_admin_products.ajax_url,t,function(e){var t,a,s,n,c,o,d,_,p,u,l,h;if(t=r("tr#edit-"+i),d=t.find("select.square-synced"),a=t.find(".wc-square-sync-with-square-errors"),!e.success&&e.data){if("multiple_attributes"===e.data)return d.prop("checked",!1),d.prop("disabled",!0),void a.find(".multiple_attributes").show();if("missing_variation_sku"===e.data)return d.prop("checked",!1),d.prop("disabled",!0),void a.find(".missing_variation_sku").show()}return o=t.find("input[name=_sku]"),p=t.find("select[name=_stock_status]"),_=t.find("input[name=_stock]"),c=t.find(".manage_stock_field .manage_stock"),n=t.find("input[name=_manage_stock]"),s='<span class="description"><a href="'+wc_square_admin_products.settings_url+'">'+wc_square_admin_products.i18n.synced_with_square+"</a></span>",u=e.data.edit_url,l=e.data.i18n,h=e.data.is_variable,d.val(e.data.is_synced_with_square),o.on("change keyup keypress",function(e){return""!==r(this).val()||h?(d.prop("disabled",!1),d.trigger("change"),a.find(".missing_sku").hide()):(d.val("no"),d.prop("disabled",!0),a.find(".missing_sku").show())}).trigger("change"),d.on("change",function(e){return"no"===r(this).val()?(n.off(),n.add(_).css({opacity:1}),c.find(".description").remove(),h?n.is(":checked")?(r(".stock_qty_field").show(),r(".backorder_field").show()):r(".stock_status_field").show():(_.prop("readonly",!1),p.prop("readonly",!1))):(n.prop("checked",!0),n.on("click",function(){return!1}),n.add(_).css({opacity:"0.5"}),c.append(s),wc_square_admin_products.is_woocommerce_sor&&u&&l&&c.append('<p class="description"><a href="'+u+'">'+l+"</a></p>"),h?(r(".stock_status_field").hide(),r(".stock_qty_field").hide(),r(".backorder_field").hide()):(_.prop("readonly",!0),p.prop("readonly",!0)))}).trigger("change")})}),"product"===h?(w="#_"+wc_square_admin_products.synced_with_square_taxonomy,p=function(){var t;return t=r("#product-type").val(),e.call(wc_square_admin_products.variable_product_types,t)>=0},_=function(){return""!==r("#_sku").val()},d=function(){var e;return e=r('.woocommerce_attribute_data input[name^="attribute_variation"]:checked'),p()&&e&&e.length>1},o=function(e){if(!p())return r("#_sku").on("change keypress keyup",function(t){return""===r(this).val()?(r(".wc-square-sync-with-square-error.missing_sku").show(),r(e).prop("disabled",!0),r(e).prop("checked",!1)):(r(".wc-square-sync-with-square-error.missing_sku").hide(),d()||r(e).prop("disabled",!1)),r(e).trigger("change")}).trigger("change")},c=function(e){return r("#variable_product_options").on("reload",function(t){return d()?(r(".wc-square-sync-with-square-error.multiple_attributes").show(),r(e).prop("disabled",!0),r(e).prop("checked",!1)):(r(".wc-square-sync-with-square-error.multiple_attributes").hide(),_()&&r(e).prop("disabled",!1)),r(e).trigger("change")}).trigger("reload")},o(w),c(w),s=r(".stock_fields"),n=s.find("#_stock"),i=r("._manage_stock_field"),a=i.find("#_manage_stock"),t=i.find(".description"),u=t.text(),l=r("#_manage_stock").is(":checked"),r(w).on("change",function(e){var i,c;if(wc_square_admin_products.is_inventory_sync_enabled)return c=-1!==r.inArray(r("#product-type").val(),wc_square_admin_products.variable_product_types),r(this).is(":checked")&&r("#_square_item_variation_id").length>0?(i=!0,t.html('<a href="'+wc_square_admin_products.settings_url+'">'+wc_square_admin_products.i18n.synced_with_square+"</a>"),a.prop("disabled",!0).prop("checked",!c).change(),n.prop("readonly",!0),c||s.show(),wc_square_admin_products.is_woocommerce_sor&&!c?(0===r("p._stock_field span.description").length&&n.after('<span class="description" style="display:block;clear:both;"><a href="#" id="fetch-stock-with-square">'+wc_square_admin_products.i18n.fetch_stock_with_square+'</a><div class="spinner" style="float:none;"></div></span>'),r("#fetch-stock-with-square").on("click",function(e){var t,i;return e.preventDefault(),(t=r("p._stock_field span.description .spinner")).css("visibility","visible"),i={action:"wc_square_fetch_product_stock_with_square",security:wc_square_admin_products.fetch_product_stock_with_square_nonce,product_id:r("#post_ID").val()},r.post(wc_square_admin_products.ajax_url,i,function(e){var i;return e&&e.success?(i=e.data,n.val(i),s.find("input[name=_original_stock]").val(i),n.prop("readonly",!1),r("p._stock_field span.description").remove()):(e.data&&(r(".inventory-fetch-error").remove(),t.after('<span class="inventory-fetch-error" style="display:inline-block;color:red;">'+e.data+"</span>")),t.css("visibility","hidden"),console.log(e))})})):wc_square_admin_products.is_square_sor&&0===r("p._stock_field span.description").length&&n.after('<span class="description" style="display:block;clear:both;">'+wc_square_admin_products.i18n.managed_by_square+"</span>")):(i=!1,r("p._stock_field span.description").remove(),n.prop("readonly",!1),t.html(u),a.prop("disabled",!1).prop("checked",l),l&&s.show()),r(".woocommerce_variation").each(function(){var e,t,a,s,n,c;return c=r(this).find("h3 > a").attr("rel"),t=r(".variable_manage_stock"),e=t.parent(),s=r(this).find(".wc_input_stock"),a=s.parent(),i?(t.prop("disabled",!0).prop("checked",!0).change(),s.prop("readonly",!0),r("#wc_square_variation_manage_stock").prop("disabled",!1),0===e.find(".description").length&&t.after('<span class="description">('+wc_square_admin_products.i18n.managed_by_square+")</span>"),wc_square_admin_products.is_woocommerce_sor?(n="fetch-stock-with-square-"+c,0===a.find("span.description").length&&s.after('<span class="description" style="display:block;clear:both;"><a href="#" id="'+n+'">'+wc_square_admin_products.i18n.fetch_stock_with_square+'</a><div class="spinner" style="float:none;"></div></span>'),r("#"+n).on("click",function(e){var t,i;return e.preventDefault(),(t=r(this).next(".spinner")).css("visibility","visible"),i={action:"wc_square_fetch_product_stock_with_square",security:wc_square_admin_products.fetch_product_stock_with_square_nonce,product_id:c},r.post(wc_square_admin_products.ajax_url,i,function(e){var i;return e&&e.success?(i=e.data,s.val(i),a.parent().find('input[name^="variable_original_stock"]').val(i),s.prop("readonly",!1),a.find(".description").remove()):(e.data&&(r(".inventory-fetch-error").remove(),t.after('<span class="inventory-fetch-error" style="display:inline-block;color:red;">'+e.data+"</span>")),t.css("visibility","hidden"),console.log(e))})})):void 0):(s.prop("readonly",!1),t.prop("disabled",!1),t.next(".description").remove(),r(this).find("#wc_square_variation_manage_stock").prop("disabled",!0))})}).trigger("change"),r("#product-type").on("change",function(e){return r(w).trigger("change")}),r("#woocommerce-product-data").on("woocommerce_variations_loaded",function(e){return r(w).trigger("change")})):void 0})}).call(void 0);
//# sourceMappingURL=wc-square-admin-products.min.js.map